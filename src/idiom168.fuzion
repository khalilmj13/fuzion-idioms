t := if s.ends_with p
       s.substring 0 s.byte_length-p.byte_length
     else
       s
